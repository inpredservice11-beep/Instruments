# Система учета выдачи и возврата инструмента

Приложение на Python с графическим интерфейсом для учета выдачи и возврата инструментов.

## Возможности

- ✅ Управление инструментами (добавление, редактирование, удаление)
- ✅ Управление сотрудниками
- ✅ Выдача инструментов с указанием ожидаемой даты возврата
- ✅ Оформление возврата инструментов
- ✅ История всех операций
- ✅ Отслеживание доступного количества инструментов
- ✅ Выделение просроченных выдач
- ✅ Поиск по инструментам и сотрудникам
- ✅ Сортировка таблиц по любому столбцу
- ✅ Сохранение размеров и позиции окна
- ✅ База данных SQLite

## Требования

- Python 3.7+
- tkinter (обычно входит в стандартную поставку Python)
- tkcalendar

## Установка

1. Клонируйте или скачайте проект

2. Установите зависимости:
```bash
pip install -r requirements.txt
```

## Запуск

```bash
python app.py
```

При первом запуске автоматически создастся база данных `tool_management.db` с тестовыми данными.

## Структура проекта

```
.
├── app.py                          # Главное приложение с GUI
├── database_manager.py             # Менеджер базы данных
├── dialogs.py                      # Диалоговые окна
├── window_config.py                # Управление конфигурацией окон
├── window_config.json              # Конфигурация размеров и позиций окон
├── requirements.txt                # Зависимости Python
├── tool_management.db              # База данных SQLite (создается автоматически)
├── database/
│   ├── 01_create_tables.sql       # SQL скрипт создания таблиц
│   └── 02_insert_sample_data.sql  # SQL скрипт тестовых данных
└── README.md                       # Этот файл
```

## Структура базы данных

### Таблицы:

1. **instruments** - инструменты (каждый уникален)
   - id, name, description, inventory_number (уникальный), serial_number
   - category, location, purchase_date, price, status
   - Статусы: Доступен, Выдан, На ремонте, Списан

2. **employees** - сотрудники
   - id, full_name, position, department
   - phone, email, status

3. **issues** - выдачи инструментов (один инструмент = одна выдача)
   - id, instrument_id, employee_id
   - issue_date, expected_return_date, actual_return_date
   - status, notes, issued_by

4. **operation_history** - история операций
   - id, issue_id, operation_type
   - instrument_id, employee_id
   - operation_date, performed_by, notes

## Использование

### Вкладка "Инструменты"
- Просмотр всех инструментов
- Добавление нового инструмента
- Редактирование информации об инструменте
- Удаление инструмента (если нет активных выдач)
- Поиск по названию, серийному номеру или категории

### Вкладка "Сотрудники"
- Просмотр всех сотрудников
- Добавление нового сотрудника
- Редактирование информации о сотруднике
- Удаление сотрудника (если нет активных выдач)
- Поиск по ФИО, должности или отделу

### Вкладка "Выдача инструмента"
- Просмотр всех активных выдач
- Создание новой выдачи с указанием:
  - Инструмента и количества
  - Сотрудника
  - Ожидаемой даты возврата
  - Примечания
- Статистика по выдачам

### Вкладка "Возврат инструмента"
- Просмотр инструментов, которые нужно вернуть
- Просроченные выдачи выделены красным
- Оформление возврата с примечанием
- Отображение количества дней в использовании

### Вкладка "История операций"
- Просмотр всех операций выдачи и возврата
- Фильтр по типу операции (Выдача/Возврат/Все)
- Выдачи выделены желтым, возвраты - зеленым

## Дополнительные возможности

### Сортировка таблиц
- Клик по заголовку столбца для сортировки по возрастанию
- Повторный клик переключает на сортировку по убыванию
- Индикаторы ▲ и ▼ показывают текущее направление сортировки
- Поддержка сортировки чисел, дат и текста

### Сохранение настроек окна
- Размеры и позиция главного окна автоматически сохраняются
- Настройки восстанавливаются при следующем запуске
- Конфигурация хранится в файле `window_config.json`
- Оптимизированное сохранение (debouncing) для плавной работы интерфейса

## Особенности

- **Уникальность инструментов**: Каждый инструмент имеет свой инвентарный номер и учитывается индивидуально
- **Контроль статуса**: Статус инструмента автоматически меняется при выдаче (Доступен → Выдан) и возврате (Выдан → Доступен)
- **Проверка доступности**: Невозможно выдать инструмент, который уже выдан или недоступен
- **Визуальные индикаторы**: 
  - Просроченные выдачи подсвечиваются красным цветом
  - Выдачи в истории выделены желтым, возвраты - зеленым
- **История операций**: Все действия записываются в историю с указанием инвентарного номера
- **Защита от удаления**: Нельзя удалить инструмент или сотрудника с активными выдачами
- **Четкие шрифты**: Автоматическая поддержка High DPI на Windows
- **Улучшенный интерфейс**: 
  - Крупные шрифты заголовков вкладок для лучшей читаемости
  - Увеличенные расстояния между кнопками для удобства использования
- **Производительность**: Оптимизированное сохранение настроек окна без задержек интерфейса
- **Рефакторинг кода**: Чистая архитектура с переиспользуемыми компонентами

## Тестовые данные

При первом запуске создаются тестовые данные:
- 20 инструментов разных категорий (каждый с уникальным инвентарным номером)
- 8 сотрудников
- 3 активные выдачи

## Автор

Создано с помощью Python и tkinter

## Лицензия

MIT License

